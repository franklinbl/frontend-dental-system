<div class="bg-white rounded-lg shadow p-8">
  <div class="flex items-center mb-6">
    <div class="flex items-center justify-center w-8 h-8 bg-blue-100 rounded-full mr-3">
      <span class="text-blue-600 font-bold text-lg">1</span>
    </div>
    <h3 class="text-xl font-semibold">Datos Personales</h3>
  </div>

  <form [formGroup]="patientForm" class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4">
    <div>
      <div class="text-gray-500 text-sm">Nombre</div>
      @if(isEditing) {
        <input
          type="text"
          formControlName="name"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-gray-300"
          [class.border-red-500]="patientForm.get('name')?.invalid && patientForm.get('name')?.touched"
          placeholder="Ingrese el nombre"
        >
        @if(getFieldError('name')) {
          <div class="text-red-500 text-xs mt-1">{{ getFieldError('name') }}</div>
        }
      } @else {
        <div class="font-medium text-base">{{ patient?.name || '-' }}</div>
      }
    </div>
    <div>
      <div class="text-gray-500 text-sm">DNI</div>
      @if(isEditing) {
        <input
          type="text"
          formControlName="dni"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-gray-300"
          [class.border-red-500]="patientForm.get('dni')?.invalid && patientForm.get('dni')?.touched"
          placeholder="Ingrese el DNI"
        >
        @if(getFieldError('dni')) {
          <div class="text-red-500 text-xs mt-1">{{ getFieldError('dni') }}</div>
        }
      } @else {
        <div class="font-medium text-base">{{ patient?.dni || '-' }}</div>
      }
    </div>
    <div>
      <div class="text-gray-500 text-sm">Nombre del representante</div>
      @if(isEditing) {
        <input
          type="text"
          formControlName="legalGuardianName"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-gray-300"
          placeholder="Ingrese el nombre del representante"
        >
      } @else {
        <div class="font-medium text-base">{{ patient?.legalGuardianName || '-' }}</div>
      }
    </div>
    <div>
      <div class="text-gray-500 text-sm">DNI del representante</div>
      @if(isEditing) {
        <input
          type="text"
          formControlName="legalGuardianDni"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-gray-300"
          placeholder="Ingrese el DNI del representante"
        >
      } @else {
        <div class="font-medium text-base">{{ patient?.legalGuardianDni || '-' }}</div>
      }
    </div>
    <div>
      <div class="text-gray-500 text-sm">Género</div>
      @if(isEditing) {
        <select
          formControlName="gender"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-gray-300"
        >
          <option value="">Seleccione género</option>
          <option value="male">Masculino</option>
          <option value="female">Femenino</option>
          <option value="other">Otro</option>
        </select>
      } @else {
        <div class="font-medium text-base">
          {{ patient?.gender === 'male' ? 'Masculino' : (patient?.gender === 'female' ? 'Femenino' : (patient?.gender === 'other' ? 'Otro' : '-')) }}
        </div>
      }
    </div>
    <div>
      <div class="text-gray-500 text-sm">Edad</div>
      @if(isEditing) {
        <input
          type="number"
          formControlName="age"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-gray-300"
          [class.border-red-500]="patientForm.get('age')?.invalid && patientForm.get('age')?.touched"
          placeholder="Ingrese la edad"
        >
        @if(getFieldError('age')) {
          <div class="text-red-500 text-xs mt-1">{{ getFieldError('age') }}</div>
        }
      } @else {
        <div class="font-medium text-base">{{ patient?.age || '-' }}</div>
      }
    </div>
    <div>
      <div class="text-gray-500 text-sm">Ocupación</div>
      @if(isEditing) {
        <input
          type="text"
          formControlName="occupation"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-gray-300"
          placeholder="Ingrese la ocupación"
        >
      } @else {
        <div class="font-medium text-base">{{ patient?.occupation || '-' }}</div>
      }
    </div>
    <div>
      <div class="text-gray-500 text-sm">Dirección</div>
      @if(isEditing) {
        <input
          type="text"
          formControlName="address"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-gray-300"
          placeholder="Ingrese la dirección"
        >
      } @else {
        <div class="font-medium text-base">{{ patient?.address || '-' }}</div>
      }
    </div>
    <div>
      <div class="text-gray-500 text-sm">Teléfono</div>
      @if(isEditing) {
        <input
          type="tel"
          formControlName="phone"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-gray-300"
          placeholder="Ingrese el teléfono"
        >
      } @else {
        <div class="font-medium text-base">{{ patient?.phone || '-' }}</div>
      }
    </div>
    <div>
      <div class="text-gray-500 text-sm">Teléfono fijo</div>
      @if(isEditing) {
        <input
          type="tel"
          formControlName="landlinePhone"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-gray-300"
          placeholder="Ingrese el teléfono fijo"
        >
      } @else {
        <div class="font-medium text-base">{{ patient?.landlinePhone || '-' }}</div>
      }
    </div>
    <div>
      <div class="text-gray-500 text-sm">Correo</div>
      @if(isEditing) {
        <input
          type="email"
          formControlName="email"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-gray-300"
          [class.border-red-500]="patientForm.get('email')?.invalid && patientForm.get('email')?.touched"
          placeholder="Ingrese el correo"
        >
        @if(getFieldError('email')) {
          <div class="text-red-500 text-xs mt-1">{{ getFieldError('email') }}</div>
        }
      } @else {
        <div class="font-medium text-base">{{ patient?.email || '-' }}</div>
      }
    </div>
    <div>
      <div class="text-gray-500 text-sm">Fecha de Nacimiento</div>
      @if(isEditing) {
        <input
          type="date"
          formControlName="birthDate"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder-gray-300"
          [class.border-red-500]="patientForm.get('birthDate')?.invalid && patientForm.get('birthDate')?.touched"
        >
        @if(getFieldError('birthDate')) {
          <div class="text-red-500 text-xs mt-1">{{ getFieldError('birthDate') }}</div>
        }
      } @else {
        <div class="font-medium text-base">{{ patient?.birthDate ? (patient?.birthDate | date:'dd/MM/yyyy') : '-' }}</div>
      }
    </div>
  </form>

  <div class="flex justify-end gap-4 mt-8">
    @if(!patient && !isEditing) {
    <button
      type="button"
      (click)="startEditing()"
      class="bg-blue-200 hover:bg-blue-600 text-gray-800 hover:text-white font-semibold py-2 px-4 rounded transition cursor-pointer"
    >
      Agregar datos
    </button>
  }
  @if(isEditing) {
    <button
      type="button"
      (click)="saveChanges()"
      class="bg-green-200 hover:bg-green-600 text-gray-800 hover:text-white font-semibold py-2 px-4 rounded transition cursor-pointer"
    >
      Guardar
    </button>
    <button
      type="button"
      (click)="cancelEditing()"
      class="bg-gray-200 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded transition cursor-pointer"
    >
      Cancelar
    </button>
  }
  @if(patient && !isEditing) {
    <button
      type="button"
      (click)="startEditing()"
      class="bg-yellow-200 hover:bg-yellow-600 text-gray-800 hover:text-white font-semibold py-2 px-4 rounded transition cursor-pointer"
    >
      Editar datos
    </button>
  }
  </div>
</div>